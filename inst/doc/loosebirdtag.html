<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Andrew Burchill" />

<meta name="date" content="2019-12-09" />

<title>Tweaking Coding Schemes: Bird Tagging Example</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Tweaking Coding Schemes: Bird Tagging Example</h1>
<h4 class="author">Andrew Burchill</h4>
<h4 class="date">2019-12-09</h4>



<p>#The Setup: In this vignette, we will tweak a color coding scheme generated by the <code>rs_IDs()</code> function. (For a very first experience with what <code>rs_IDs()</code> does, I recommend checking out the Shiny-based GUI for the function by running <code>exampleGUI()</code>.)</p>
<p>In our particular hypothetical situation, we plan on putting color bands around the legs of some bird. We have eight different band colors, and we want to put five bands on each bird: two bands below each of the bird’s “ankles” (around the tarsometatarsus) and one band above the bird’s right “ankle” joint (around the right tibiotarsus). A horrible “graphical” representation can be seen below, where <code>{1}</code>, <code>{2}</code>, <code>{3}</code>, <code>{4}</code>, and <code>{5}</code> refer to the five unique banding positions.</p>
<pre><code>     |   |            |  {5}
     o   o            o   o
     |   |     =&gt;    {1} {3}
     .   .           {2} {4}
    /|\ /|\          /|\ /|\</code></pre>
<p>Let us say that these bands fall off somewhat frequently; we want our coding scheme to be robust to the loss of two bands. If these bands occupy unique positions and can’t be moved around, we can use the <code>rs_IDs()</code> function without further modification.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">alphabet &lt;-<span class="st"> </span><span class="dv">8</span>      <span class="co"># the number of colors we have</span></a>
<a class="sourceLine" id="cb2-2" title="2">total.length &lt;-<span class="st"> </span><span class="dv">5</span>  <span class="co"># the number of positions we want band</span></a>
<a class="sourceLine" id="cb2-3" title="3">redundancy &lt;-<span class="st"> </span><span class="dv">2</span>    <span class="co"># how many bands we can lose but still ID perfectly</span></a>
<a class="sourceLine" id="cb2-4" title="4">codes &lt;-<span class="st"> </span>rabi<span class="op">::</span><span class="kw">rs_IDs</span>(total.length, redundancy, alphabet)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Our list contains &quot;</span>, <span class="kw">length</span>(codes), <span class="st">&quot; unique IDs.&quot;</span>))</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">head</span>(codes, <span class="dt">n =</span> 10L)</a></code></pre></div>
<pre><code>!! Warning in rabi::rs_IDs(total.length, redundancy, alphabet): NOTE: Reed-
!! Solomon codes require the &#39;alphabet size&#39; (e.g. the number of paint colors
!! you have) to be a prime number. Automatically adjusting to use an alphabet
!! size 7 instead of the entered value of 8.</code></pre>
<pre><code>#&gt; [1] &quot;Our list contains 343 unique IDs.&quot;</code></pre>
<table>
<caption>ID sequences in the unaltered list</caption>
<thead>
<tr class="header">
<th align="center">{1}</th>
<th align="center">{2}</th>
<th align="center">{3}</th>
<th align="center">{4}</th>
<th align="center">{5}</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">4</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">5</td>
<td align="center">5</td>
<td align="center">5</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">6</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">4</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">3</td>
<td align="center">4</td>
<td align="center">5</td>
<td align="center">6</td>
</tr>
</tbody>
</table>
<p>Congratulations! It’s as simple as one line of code. <strong>Note the error: this lets us know that we aren’t getting as much out of <code>rs_IDs()</code> as we could.</strong></p>
<p>#The Problem:</p>
<p>Actually, things aren’t so simple; things get a bit trickier. In reality, these bands may be relatively loose around the legs of the bird. The unique positions of bands <code>{1}</code> and <code>{3}</code> are probably only maintained due to the physical presence of bands <code>{2}</code> and <code>{4}</code>. If <code>{2}</code> or <code>{4}</code> were to somehow be removed, the band above them would succumb to gravity and descend into the newly vacated position. In the below “diagram,” we see that a loss of both <code>{1}</code> and <code>{2}</code> will yield the same final configuration. In this case, it would be impossible to tell the original position of the remaining band.</p>
<pre><code>     |  {5}           |  {5}           |  {5}
     o   o            o   o            o   o
    {1} {3}   AND     x  {3}    =&gt;     |  {3}
     x  {4}          {2} {4}          {?} {4}
    /|\ /|\          /|\ /|\          /|\ /|\</code></pre>
<p>It becomes clear that a loss in <code>{1}</code> would make the ID code <strong>3,4</strong>,2,4,0 indistinguishable from <strong>4,3</strong>,2,4,0 or <strong>5,3</strong>,2,4,0 or <strong>3,0</strong>,2,4,0 etc. (A similar dilemma is caused by losses in <code>{3}</code> or <code>{4}</code>.) The generated codes can still totally correct for a <em>single</em> erasure anywhere, but accounting for both an erasure AND an uncertain position “costs” the same as a double erasure. So if one erasure happens between <code>{1}</code> and <code>{2}</code> and a second erasure happens between <code>{3}</code> and <code>{4}</code>, we would need the code to be robust to FOUR erasures, which would render it quite useless.</p>
<p>The best fix for this is not easily apparent. Let’s first try to work around it just by manipulating our coding scheme.</p>
<p>#Some Solutions:</p>
<p>##Pruning the coding list</p>
<p>One possible idea: prune the list of codes so that the top bands, <code>{1}</code> and <code>{3}</code>, are only odd numbers and the bottom bands, <code>{2}</code> and <code>{4}</code>, are only even numbers. That way, a lone even-numbered band indicates that the upper band has been lost, etc.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"> <span class="co">#create a function for determining odd or even</span></a>
<a class="sourceLine" id="cb6-2" title="2">odd &lt;-<span class="st"> </span><span class="cf">function</span>(x){ x <span class="op">%%</span><span class="st"> </span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">1</span> }</a>
<a class="sourceLine" id="cb6-3" title="3"> <span class="co">#turn the code list into a matrix for easier manipulation</span></a>
<a class="sourceLine" id="cb6-4" title="4">codes &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">do.call</span>(<span class="st">&quot;cbind&quot;</span>,codes)) </a>
<a class="sourceLine" id="cb6-5" title="5"> <span class="co">#only select the codes where {1} and {3} are odd, and {2} and {4} are even</span></a>
<a class="sourceLine" id="cb6-6" title="6">codes &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="st">  </span>codes[<span class="kw">which</span>(<span class="kw">odd</span>(codes[,<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">odd</span>(codes[,<span class="dv">3</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(codes[,<span class="dv">2</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(codes[,<span class="dv">4</span>])), ]</a>
<a class="sourceLine" id="cb6-8" title="8"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;Our new list contains &quot;</span>, <span class="kw">dim</span>(codes)[<span class="dv">1</span>], <span class="st">&quot; unique IDs.&quot;</span>))</a></code></pre></div>
<pre><code>#&gt; [1] &quot;Our new list contains 22 unique IDs.&quot;</code></pre>
<p>Damn. That’s almost nothing…</p>
<p>###Using the <code>tweaked_IDs()</code> function However, we can possibly increase that number by using the <code>tweaked_IDs()</code> function. It’s the same as <code>brute_IDs()</code>, but instead of pruning down a list of ALL possible ID sequences, we can specify our constraints first and then generate that list.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"> <span class="co">#create a matrix of all possible sequences</span></a>
<a class="sourceLine" id="cb8-2" title="2">perms &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">list</span>(<span class="kw">seq_len</span>(alphabet)),total.length)</a>
<a class="sourceLine" id="cb8-3" title="3">combos &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">expand.grid</span>(perms)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-4" title="4"> <span class="co">#only keep sequences that fit our constraints</span></a>
<a class="sourceLine" id="cb8-5" title="5">combos1 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="st">  </span>combos[<span class="kw">which</span>(<span class="kw">odd</span>(combos[,<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">odd</span>(combos[,<span class="dv">3</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(combos[,<span class="dv">2</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(combos[,<span class="dv">4</span>])), ]</a>
<a class="sourceLine" id="cb8-7" title="7">codes &lt;-<span class="st"> </span>rabi<span class="op">::</span><span class="kw">tweaked_IDs</span>(combos1, redundancy, <span class="dt">num.tries =</span> <span class="dv">1</span>)  <span class="co">#we&#39;re only running it once for speed</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;The &#39;tweaked&#39; list contains &quot;</span>, <span class="kw">length</span>(codes), <span class="st">&quot; unique IDs.&quot;</span>))</a></code></pre></div>
<pre><code>#&gt; [1] &quot;The &#39;tweaked&#39; list contains 42 unique IDs.&quot;</code></pre>
<p>Okay, that’s still not much better…</p>
<p>##Using empty spaces</p>
<p>Still not good enough? Perhaps you find it annoying that the top bands can only be odd. Perhaps we could get more IDs if we weren’t so constrained. To further add IDs, we could have the top and bottom bands merely be opposites in terms of oddness or evenness. For example, if <code>{3}</code> is even, <code>{4}</code> is odd; if <code>{3}</code> is odd, <code>{4}</code> is even. But how could we indicate to the observer which level is even and which is odd?</p>
<p>Well, although <code>{5}</code> is around the right tibiotarsus, there is an unused spot around the left tibiotarsus. If we allow <code>{5}</code> to occupy either position (see below), we can encode a bit more information in the ID sequence.</p>
<pre><code>     |  {5}          {5}  |
     o   o            o   o
    {1} {3}    OR    {1} {3}
    {2} {4}          {2} {4}
    /|\ /|\          /|\ /|\</code></pre>
<p>We can arbitrarily say that when <code>{5}</code> is on the right leg, the top bands <code>{1}</code> and <code>{3}</code> are odd. When <code>{5}</code> is on the left side, the top bands <code>{1}</code> and <code>{3}</code> are even. However, if <code>{5}</code> fell off, we might think that this information is lost. Not so! Imagine that <code>{5}</code> and <code>{3}</code> fell off: we can reconstruct both <code>{5}</code>’s position and <code>{3}</code>’s “oddness”&quot; by looking at <code>{1}</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"> <span class="co">#only select sequences where the top and bottom bands differ in &quot;oddness&quot;</span></a>
<a class="sourceLine" id="cb11-2" title="2">combos2 &lt;-<span class="st"> </span>combos[<span class="kw">which</span>((</a>
<a class="sourceLine" id="cb11-3" title="3">      (<span class="kw">odd</span>(combos[,<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">odd</span>(combos[,<span class="dv">3</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(combos[,<span class="dv">2</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(combos[,<span class="dv">4</span>])) <span class="op">|</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">      </span>(<span class="op">!</span><span class="kw">odd</span>(combos[,<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(combos[,<span class="dv">3</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">odd</span>(combos[,<span class="dv">2</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">odd</span>(combos[,<span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb11-5" title="5">      )), ]</a>
<a class="sourceLine" id="cb11-6" title="6">codes &lt;-<span class="st"> </span>rabi<span class="op">::</span><span class="kw">tweaked_IDs</span>(combos2, redundancy, <span class="dt">num.tries =</span> <span class="dv">1</span>)  <span class="co">#we&#39;re only running it once for speed</span></a>
<a class="sourceLine" id="cb11-7" title="7"> <span class="co">#add either a &quot;left&quot; or &quot;right&quot; indicating which leg {5} is on</span></a>
<a class="sourceLine" id="cb11-8" title="8">codes &lt;-<span class="st"> </span><span class="kw">lapply</span>(codes, <span class="cf">function</span>(x) <span class="cf">if</span>(<span class="kw">odd</span>(x[[<span class="dv">1</span>]])) {<span class="kw">append</span>(x,<span class="st">&quot;R&quot;</span>)} <span class="cf">else</span> {<span class="kw">append</span>(x,<span class="st">&quot;L&quot;</span>)})</a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;The &#39;tweaked&#39; list contains &quot;</span>, <span class="kw">length</span>(codes), <span class="st">&quot; unique IDs.&quot;</span>))</a>
<a class="sourceLine" id="cb11-10" title="10"><span class="kw">head</span>(codes, <span class="dt">n =</span> 10L)</a></code></pre></div>
<pre><code>#&gt; [1] &quot;The &#39;tweaked&#39; list contains 82 unique IDs.&quot;</code></pre>
<table>
<caption>ID sequences in variable position list</caption>
<thead>
<tr class="header">
<th align="center">{1}</th>
<th align="center">{2}</th>
<th align="center">{3}</th>
<th align="center">{4}</th>
<th align="center">{5}</th>
<th align="center">{5}’s Position</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">3</td>
<td align="center">6</td>
<td align="center">0</td>
<td align="center">R</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">7</td>
<td align="center">4</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">L</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">0</td>
<td align="center">5</td>
<td align="center">6</td>
<td align="center">7</td>
<td align="center">R</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">4</td>
<td align="center">7</td>
<td align="center">2</td>
<td align="center">7</td>
<td align="center">R</td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">6</td>
<td align="center">3</td>
<td align="center">6</td>
<td align="center">L</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">5</td>
<td align="center">4</td>
<td align="center">7</td>
<td align="center">1</td>
<td align="center">L</td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">3</td>
<td align="center">0</td>
<td align="center">7</td>
<td align="center">0</td>
<td align="center">L</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">7</td>
<td align="center">6</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">L</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">6</td>
<td align="center">5</td>
<td align="center">6</td>
<td align="center">5</td>
<td align="center">R</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">7</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">4</td>
<td align="center">L</td>
</tr>
</tbody>
</table>
<p>Although this is the best so far, to really make this work we’ll probably need to further change the physical setup of the tagging system.</p>
<p>##Removing ambiguity</p>
<p>If we consider the option of physically altering the setup, we find a very simple solution: on the upper color bands <code>{1}</code> and <code>{3}</code>, add some sort of dark, high-contrast mark. Perhaps something as simple as darkening the upper half of these bands with a sharpie would work. Adding additional markings to the bands can give the banding positions uniqueness in the face of gravity and detachment. However, this class of solutions is very dependent on your situation.</p>
<p>Barring something this simplistic, we could move <code>{1}</code> up above the “ankle” and around the left tibiotarsus. Now only <code>{3}</code> and <code>{4}</code> share a confusable position. The new arrangement would look something like this:</p>
<pre><code>     |  {5}          {1} {5}
     o   o            o   o
    {1} {3}    =&gt;     |  {3}
    {2} {4}          {2} {4}
    /|\ /|\          /|\ /|\</code></pre>
<p>Our code:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"> <span class="co">#now, only {3} and {4} need to be constrained as odd and even, respectively</span></a>
<a class="sourceLine" id="cb14-2" title="2">combos3 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="st">  </span>combos[<span class="kw">which</span>(<span class="kw">odd</span>(combos[,<span class="dv">3</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">odd</span>(combos[,<span class="dv">4</span>])), ]</a>
<a class="sourceLine" id="cb14-4" title="4">codes &lt;-<span class="st"> </span>rabi<span class="op">::</span><span class="kw">tweaked_IDs</span>(combos3, redundancy, <span class="dt">num.tries =</span> <span class="dv">1</span>)  <span class="co">#we&#39;re only running it once for speed</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;This last list contains &quot;</span>, <span class="kw">length</span>(codes), <span class="st">&quot; unique IDs.&quot;</span>))</a></code></pre></div>
<pre><code>#&gt; [1] &quot;This last list contains 103 unique IDs.&quot;</code></pre>
<p>There are many, many other ways to tweak both the tagging setup and the code list. I’m sure many of them could generate even more unique IDs than the ways I’ve outlined above. However, it’s important to keep in mind that the functions in <code>rabi</code> ASSUME there is no weird uncertainty and sliding around of banding positions. If you are going to use these functions to help create codes for your own weird situation, I would make sure you write up a function that properly tests your lists to verify they are appropriately robust.</p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
